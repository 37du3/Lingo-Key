# Tran Chrome Extension — 资深产品经理审阅意见

**审阅日期**: 2026-02-12
**审阅文档**: `2026-02-12-tran-chrome-extension-design.md`
**审阅角色**: Senior Product Manager

---

## 一、总体评价

这是一份**质量较高**的技术设计文档。核心价值主张清晰（消除输入场景下的复制-粘贴-翻译循环）、架构选型合理（MV3 + Service Worker）、MVP 边界克制。以下从产品视角提出需要关注的问题和改进建议。

---

## 二、亮点 ✅

| 维度 | 评价 |
|------|------|
| **用户痛点** | 精准切入"输入框场景"，而非泛翻译工具的红海竞争 |
| **Undo 支持** | 利用 `execCommand` 融入浏览器原生撤销栈，降低用户心理负担 |
| **隐私模型** | 用户自带 API Key、数据不经第三方服务器、不同步云端，对开发者群体极具吸引力 |
| **流式体验** | 逐步替换而非等待全部翻译完成，感知延迟大幅降低 |
| **失败回滚** | 快照+恢复机制保证数据安全，避免用户辛苦输入被丢失 |
| **范围克制** | V1 排除 Notion/Google Docs 等复杂编辑器，风险可控 |

---

## 三、需补充或改进的问题 ⚠️

### 3.1 目标用户与场景定义缺失

> [!IMPORTANT]
> 文档缺少**用户画像（Persona）**和**核心使用场景（Use Case）**描述。

- 目前隐含的用户是"需要用英文回复的中文开发者"，但这应该**显式写出来**
- 建议补充 2-3 个典型场景，例如：
  - GitHub Issue/PR 中回复英文评论
  - Stack Overflow 发帖或回答
  - 英文邮件回复（Gmail、Outlook Web）
  - Slack/Teams 发送英文消息
- 场景定义直接影响**测试策略的优先级排序**

### 3.2 翻译方向的灵活性

- 文档标题为"中文翻译扩展"，但实际 Prompt 设计支持任意语言到目标语言的翻译
- **建议**：明确产品定位——是"中文→英文"的专用工具，还是"任意语言→目标语言"的通用翻译器？
- 如果定位为通用工具，产品名、文案、Prompt 默认值都需要调整

### 3.3 "往前截取 N 个字符"策略的风险

> [!WARNING]
> 无选中文本时"从光标往前截取最多 N 个字符"是一个**高风险的默认行为**。

- **场景问题**：用户可能在一段英文后输入了一句中文，截取 500 字符会把前面的英文一起发给 LLM 翻译
- **Token 浪费**：不必要的长文本增加 API 成本
- **建议方案**：
  1. 优先取**最近一段连续的非目标语言文本**（如连续 CJK 字符段落）
  2. 遇到段落分隔符（换行、空行）时截断
  3. 或者退而求其次：**V1 强制要求用户先选中文本**，去掉"自动往前截取"的行为，降低出错概率

### 3.4 翻译过程中的输入冲突

文档提到"检测到用户输入则 abort 翻译并恢复原文"，这里有几个细节需要确认：

- **恢复到什么状态？** 恢复到触发翻译前的原文 + 已收到的部分译文？还是完全恢复原文？
  - 建议：**完全恢复原文**，避免出现"半中半英"的混乱状态
- **检测用户输入的方式？** 监听 `keydown`、`input`、还是 `compositionstart`（中文输入法预编辑）？
  - 中文输入法的 composition 事件需要特别处理，否则可能误判
- **建议**：明确写出中断后的恢复策略，这是用户信任的关键

### 3.5 首次使用体验（FTUE/Onboarding）

> [!IMPORTANT]
> 文档完全没有描述**首次安装后的引导流程**。

- 用户安装扩展后最可能的行为：直接按 `Alt+T` → 报错 → 困惑
- **建议**：
  1. 安装后自动打开 Options Page 或展示一个 Welcome 页面
  2. 未配置 API Key 时的 Toast 可点击直通设置页（文档已提到这一点 ✓，但建议**做成一个更明显的引导条而非 Toast**）
  3. Options Page 增加 Quick Start 指引，告知用户在哪里获取 API Key

### 3.6 快捷键方案的风险

- `Alt+T` 在部分操作系统/浏览器/网站中可能有冲突
  - macOS Chrome 中 `Alt` 键输入会产生特殊字符（如 `Alt+T` 会输入 `†`）
  - 部分网站（如 Notion、Figma）会拦截 `Alt` 热键
- **建议**：
  1. macOS 上默认使用 `Ctrl+Shift+T` 或 `Cmd+Shift+T`（需避开 Chrome 内建的"恢复标签"快捷键）
  2. 文档快捷键部分应列出**各平台的默认值**
  3. 或者使用 Chrome 原生的 `chrome.commands` API 管理快捷键，让用户在 `chrome://extensions/shortcuts` 中统一管理

### 3.7 Options Page 设计补充

- **缺少"重置为默认"按钮**
- **API Base URL 缺少验证**：用户可能输入不含 `/v1` 后缀的 URL，或者输入带尾部 `/` 的 URL —— 需要做标准化处理
- **"测试连接"按钮**很好 👍，但需要明确：
  - 测试成功/失败的反馈形式是什么？内联文字？Toast？
  - 测试时发送什么内容？建议发送一个极简 prompt（如 "Hi"）验证 API 可达性即可
- **自定义 Prompt 的可用性**：`{{target_language}}` 模板变量对非技术用户不友好
  - 建议：提供预设 Prompt 模板 + "高级自定义"折叠区域

### 3.8 缺少指标与成功定义

作为 PM 视角最关键的缺失：

- **没有定义成功指标**。建议补充：
  - 翻译成功率（成功完成 / 触发总数）
  - 平均翻译延迟（首 token 时间、完成时间）
  - 用户撤销率（频繁撤销说明翻译质量不满意）
  - 每日活跃翻译次数
- **实现方式**：这些指标可以纯本地统计（存 `chrome.storage.local`），不违反隐私承诺
- 这些数据对后续迭代的方向判断至关重要

---

## 四、技术风险标注 🔴

| 风险项 | 严重度 | 说明 |
|--------|--------|------|
| `execCommand` 废弃 | 中 | 文档已提到隔离策略 ✓，但建议设立监控，跟踪 Chrome Release Notes |
| React/Vue 受控组件兼容 | 高 | 流式高频操纵 DOM 可能和框架状态管理冲突，**V1 必须对 GitHub、Gmail 等主要站点做 E2E 验证** |
| `contenteditable` 适配 | 高 | 不同网站的 `contenteditable` 实现差异巨大（Slack 用 Draft.js、GitHub 用 Markdown editor），需要明确 V1 支持的最小集合 |
| macOS `Alt` 键行为 | 中 | 上文已提及，直接影响 macOS 用户的可用性 |

---

## 五、建议补充的功能（V1.1 Roadmap 参考）

| 功能 | 理由 |
|------|------|
| **语言自动检测** | 去掉"中文翻译扩展"的限定，让 LLM 判断源语言 |
| **翻译历史记录** | 本地记录最近 N 条翻译，方便复用 |
| **右键菜单入口** | 除了快捷键之外提供一个可发现的触发方式 |
| **多种翻译风格** | 预设"正式/口语/简洁"等风格模板 |
| **字数/Token 统计** | 帮助用户了解 API 使用情况和成本 |

---

## 六、结论

**评级：✅ 可以进入开发阶段**

文档在技术架构、核心交互、错误处理方面思考较为完整。主要短板在**产品层面的用户体验细节**（FTUE、智能选文、快捷键平台适配）和**成功指标定义**。建议在开发启动前补充以下三项：

1. **明确 macOS 默认快捷键方案**（阻塞项，直接影响可用性）
2. **确认"往前截取"策略的边界处理**（或 V1 简化为必须选中文本）
3. **补充首次使用引导流程**

其余建议可在开发过程中逐步完善。
